syntax = "proto3";

package agent;

option go_package = "github.com/zhinea/sylix/internal/infra/proto/agent";

service Agent {
    rpc GetStatus (GetStatusRequest) returns (GetStatusResponse);
    rpc Heartbeat (HeartbeatRequest) returns (HeartbeatResponse);
    rpc Ping (PingRequest) returns (PingResponse);
    rpc GetConfig (GetConfigRequest) returns (GetConfigResponse);
    rpc CreateDatabase (CreateDatabaseRequest) returns (CreateDatabaseResponse);
}

message GetStatusRequest {}

message GetStatusResponse {
    string status = 1;
    string version = 2;
    int64 uptime = 3;
}

message HeartbeatRequest {
    string agent_id = 1;
    int64 timestamp = 2;
}

message HeartbeatResponse {
    bool acknowledged = 1;
}

message PingRequest {
    int64 timestamp = 1;
}

message PingResponse {
    int64 timestamp = 1;
    string status = 2;
}

message GetConfigRequest {}

message GetConfigResponse {
    string config = 1;
    string timezone = 2;
}

message CreateDatabaseRequest {
    string name = 1;
    string user = 2;
    string password = 3;
    string db_name = 4;
    string branch = 5;
}

message CreateDatabaseResponse {
    string container_id = 1;
    int32 port = 2;
    string status = 3;
}
